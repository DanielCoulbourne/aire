!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r((e=e||self).Aire={})}(this,function(e){"use strict";function p(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(t.push(o.value),!r||t.length!==r);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return t}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function y(e){return function(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function v(e){var r=new FormData(e),t={},n=!0,i=!1,a=void 0;try{for(var o,s=r.entries()[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var l=p(o.value,2),c=l[0],u=l[1],f=c.replace(/\[]$/,""),d=f!==c;t[f]?(t[f]instanceof Array||(t[f]=[t[f]]),t[f].push(u)):t[f]=d?[u]:u}}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return t}var h=!1,l={templates:{error:{prefix:"<li>",suffix:"</li>"}},classnames:{none:{},valid:{},invalid:{}}},m=function(e){e.form;var r=e.errors,t=e.data,n=e.rules,i=e.refs,a=e.touched,o=l,s=o.templates,v=o.classnames;Object.keys(n).forEach(function(e){if(e in i){var f=a.has(e)&&e in r,d=a.has(e)&&!f&&e in t;"errors"in i[e]&&(d?(i[e].errors[0].classList.add("hidden"),i[e].errors[0].innerHTML=""):f&&(i[e].errors[0].classList.remove("hidden"),i[e].errors[0].innerHTML=r[e].map(function(e){return"".concat(s.error.prefix).concat(e).concat(s.error.suffix)}).join(""))),Object.entries(i[e]).forEach(function(e){var r=p(e,2),u=r[0];r[1].forEach(function(e){if(u in v.valid){var r,t,n=v.valid[u].split(" ");if(n.length)if(d)(r=e.classList).add.apply(r,y(n));else(t=e.classList).remove.apply(t,y(n))}if(u in v.invalid){var i,a,o=v.invalid[u].split(" ");if(o.length)if(f)(i=e.classList).add.apply(i,y(o));else(a=e.classList).remove.apply(a,y(o))}if(u in v.none){var s,l,c=v.none[u].split(" ");if(c.length)if(d||f)(s=e.classList).remove.apply(s,y(c));else(l=e.classList).add.apply(l,y(c))}})})}})},g="undefined"!=typeof FormData&&"getAll"in FormData.prototype;e.configure=function(e){l=e},e.connect=function(e,r,t){var i=1<arguments.length&&void 0!==r?r:{},a=2<arguments.length&&void 0!==t?t:{};if(!g)return null;h||(Validator.registerMissedRuleValidator(function(){return!0},""),Validator.useLang("en")),h=!0;var o,s=function(e){return"string"==typeof e?document.querySelector(e):e}(e),l={};s.querySelectorAll("[data-aire-component]").forEach(function(e){if("aireFor"in e.dataset){var r=e.dataset.aireFor,t=e.dataset.aireComponent;l[r]=l[r]||{},t in l[r]?l[r][t].push(e):l[r][t]=[e]}});function c(e){var r=e.target.getAttribute("name");r&&d.add(r.replace(/\[]$/,""))}function n(e){void 0!==e&&"target"in e&&c(e);var n=0;clearTimeout(u),u=setTimeout(function(){var e=v(s);o=new Validator(e,i,a);var r=++n;1==r&&Object.entries(e).forEach(function(e){var r=p(e,2),t=r[0],n=r[1];null!=n&&""!==n&&(Array.isArray(n)&&0===n.length||d.add(t))});function t(){f&&r===n&&m({form:s,rules:i,touched:d,refs:l,data:e,errors:o.errors.all()})}o.checkAsync(t,t)},250)}var u,f=!0,d=new Set;s.addEventListener("change",n,!0),s.addEventListener("keyup",n,!0),s.addEventListener("focus",c,!0),n();return{get valid(){return void 0!==o&&0===Object.keys(o.errors.all()).length},get data(){return void 0===o?v(s):o.input},get validator(){return o},run:n,disconnect:function(){f=!1,clearTimeout(u),s.removeEventListener("change",n),s.removeEventListener("keyup",n),s.removeEventListener("focus",c)}}},e.setRenderer=function(e){m=e},e.supported=g,Object.defineProperty(e,"__esModule",{value:!0})});
